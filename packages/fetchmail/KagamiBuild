# Description: A remote-mail retrieval utility
# URL:         http://www.fetchmail.info
# Maintainer:  protonesso, nagakamira at gmail dot com
# Depends on:  libressl
# Section:     mail

name=fetchmail
version=6.3.26
release=1
source=("http://downloads.sourceforge.net/project/$name/branch_6.3/$name-$version.tar.xz")

build() {
	cd "$SRC"/$name-$version
	patch -Np1 -i "$STUFF"/fetchmail/fetchmail-6.3.26-libressl.patch

	sed -i 's|/usr/bin/env python|/usr/bin/env python2|' fetchmailconf.py
	sed -i '19,21s/^/#/' Makefile.am
	autoreconf -vi

	for a in $(find . -name config.sub); do
		cp "$STUFF"/config.sub $a
	done

	for a in $(find . -name config.guess); do
		cp "$STUFF"/config.guess $a
	done

	./configure $BUILDFLAGS \
		--prefix=/usr \
		--with-ssl=/usr \
		--disable-nls
	make
	make DESTDIR="$PKG" install
}
