# Description: Configuration database system
# URL:         https://wiki.gnome.org/Projects/dconf
# Maintainer:  protonesso, nagakamira at gmail dot com
# Depends on:  meson vala glib libxslt dbus
# Section:     gnome

name=dconf
version=0.34.0
release=2
source=("http://ftp.gnome.org/pub/gnome/sources/$name/${version%.*}/$name-$version.tar.xz"
	"$name.trigger")

build() {
	cd "$SRC"/$name-$version
	sed -i 's|link_whole|link_with|' common/meson.build
	sed -i 's/module/& | grep -v mangle_path/' gsettings/abicheck.sh

	mkdir -p build
	cd build
	ataraxia-meson "$SRC"/$name-$version \
		-Dgtk_doc=false \
		-Dman=false
	ninja
	DESTDIR="$PKG" ninja install

	mkdir -p "$PKG"/etc/dconf/db

	install -Dm0644 "$SRC"/$name.trigger "$PKG"/var/lib/neko-triggers/$name
}
