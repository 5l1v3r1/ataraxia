# Description: Dependency based init system
# URL:         https://github.com/OpenRC/openrc/
# Maintainer:  protonesso, nagakamira at gmail dot com
# Depends on:  pam kmod util-linux busybox
# Priority:    required
# Section:     base

name=openrc
version=0.42.1
release=1
options=('bootstrap')
source=("https://github.com/OpenRC/openrc/archive/$version.tar.gz")

build() {
	makeargs=(BRANDING="\e[35mAtaraxia Linux\e[0m")
	makeargs+=(MKSELINUX=no)
	makeargs+=(MKTERMCAP=ncurses)
	makeargs+=(MKPAM=pam)
	makeargs+=(PKG_PREFIX="")
	makeargs+=(LIBDIR=/usr/lib)
	makeargs+=(LIBMODE=0644)
	makeargs+=(SHLIBDIR=/usr/lib)
	makeargs+=(LIBEXECDIR=/usr/lib/openrc)
	makeargs+=(BINDIR=/usr/bin)
	makeargs+=(SBINDIR=/usr/bin)
	makeargs+=(MKBASHCOMP=yes)
	makeargs+=(MKZSHCOMP=yes)
	makeagrs+=(LIBNAME=lib)

	cd "$SRC"/$name-$version
	patch -Np1 -i "$STUFF"/openrc/0003-sysctl-add-compatibility-for-busybox-sysctl.patch

	make "${makeargs[@]}"
	make "${makeargs[@]}" DESTDIR="$PKG" install
}
