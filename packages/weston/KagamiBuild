# Description: Reference implementation of a Wayland compositor
# URL:         https://wayland.freedesktop.org/
# Maintainer:  protonesso, nagakamira at gmail dot com
# Depends on:  meson libdrm libx11 libxcb libxcursor cairo libinput libpng libjpeg-turbo libxkbcommon mesa mtdev wayland-protocols glu pango libwebp lcms2 libva dbus
# Section:     x11

name=weston
version=6.0.1
release=1
source=("https://wayland.freedesktop.org/releases/$name-$version.tar.xz")

build() {
	cd "$SRC"/$name-$version
	patch -Np1 -i "$STUFF"/weston/no-error.patch
	patch -Np1 -i "$STUFF"/weston/no-pam.patch
	patch -Np1 -i "$STUFF"/weston/no-pam-meson.patch

	mkdir -p build
	cd build

	ataraxia-meson "$SRC"/$name-$version \
		-Dlauncher-logind=false \
		-Dsimple-dmabuf-drm=auto \
		-Dsystemd=false
	ninja
	DESTDIR="$PKG" ninja install
}
