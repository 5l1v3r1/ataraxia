# Description: D-Bus interface for user account query and manipulation
# URL:         https://gitlab.freedesktop.org/accountsservice/accountsservice
# Maintainer:  protonesso, nagakamira at gmail dot com
# Depends on:  gobject-introspection libgcrypt polkit
# Section:     admin

name=accountsservice
version=0.6.45
release=1
source=("https://www.freedesktop.org/software/$name/$name-$version.tar.xz")

#build() {
#	cd "$SRC"/$name-$version
#	patch -Np1 -i "$STUFF"/accountsservice/musl-fgetspent_r.patch
#	patch -Np1 -i "$STUFF"/accountsservice/musl-wtmp.patch
#
#	sed -i '/dbus_conf_dir/s/sysconfdir/datadir/g' meson.build
#
#	mkdir -p build
#	cd build
#	ataraxia-meson "$SRC"/$name-$version \
#		-Dadmin_group=wheel \
#		-Ddocbook=false \
#		-Delogind=false \
#		-Dsystemd=false \
#		-Dsystemdsystemunitdir=no
#	ninja
#	DESTDIR="$PKG" ninja install
#}

build() {
	cd "$SRC"/$name-$version
	patch -Np1 -i "$STUFF"/accountsservice/musl-fgetspent_r.patch
	patch -Np1 -i "$STUFF"/accountsservice/musl-wtmp.patch

	./configure $BUILDFLAGS \
		--prefix=/usr \
		--libexecdir=/usr/lib \
		--sysconfdir=/etc \
		--localstatedir=/var \
		--enable-admin-group=wheel \
		--disable-gtk-doc \
		--disable-systemd
	make
	make DESTDIR="$PKG" install
}
